# AIマーダーミステリー案: 「硝子ログの遺言」

## 目的

ハッカソン審査で重視される「実際に遊べること」を最優先に、
AI技術はゲーム性を補強する範囲に限定して実装する。

## この企画で守るマダミス原則

- 情報は全員に均等ではなく、各プレイヤーが秘密情報を持つ
- 会話だけでなく、行動選択で入手情報が変わる
- 「犯人当て」だけでなく、各プレイヤーに個別勝利条件がある
- 最後は必ず全員が1回だけ投票/告発を行う
- エンディングは「事件の真相」と「各人の目的達成」を分離して判定する

## 世界観

次世代AI人格を運用する実験棟「GLASS-9」。
停電復旧後、主任研究員・真壁レンがサーバールームで死亡。
物理扉は内側からロック、監視ログは一部改ざんされている。

## プレイ人数と役割

- プレイ人数: `n人（3 <= n <= 8）`
- GMは置かず、進行AIがフェーズ制御を行う
- 初期リリースは `全員AIプレイヤー` を標準モードにする
- 人間参加モードでは、参加人数に応じて不足ロールをAIが補完する

### ロールプール（例）

- プロジェクトマネージャー（被害者と予算対立）
- セキュリティ責任者（ログ改ざん疑惑）
- 研究補佐（被害者の秘密を知る）
- 外部監査人（全員を疑う立場）
- 医療主任（死因情報にアクセス可能）
- インフラ担当（停電と復旧手順に詳しい）
- 倫理委員（規約違反の証拠を握る）
- 派遣エンジニア（立場が弱く疑われやすい）

### 役割割り当てルール

- セッション開始時に `rolePool` から `n` 件をランダム抽選
- バランス制約:
  - 情報強者ロールは最大2
  - 明確な不利ロールを最低1含める
  - 犯行実行可能ロールを最低2含める
- 人間参加モードでは、抽選ロールを人間に優先配布し、余りをAIに割当

## ゲームループ（1セッション45分）

### Phase 0: 導入（5分）

- 共通公開情報を配布
- 各プレイヤー（AI含む）に個別ハンドアウト（秘密、関係性、個人目標）を配布

### Phase 1: 初動調査（10分）

- 各プレイヤーは2アクションを選択
- 例: `NPC尋問` `現場検証` `端末ログ照会` `人物追跡`
- 同じ場所を調べても、役職により見える情報が変わる

### Phase 2: 全体議論（12分）

- 全員同席で情報共有と疑い先のすり合わせ
- この時点では嘘をついてもよい（ルール上許可）
- 全員AIモードでは、各AIが「公開してよい情報量」を戦略的に調整する

### Phase 3: 再調査（10分）

- Phase 2で出た矛盾を起点に、各プレイヤーが1アクション追加
- 新証拠の開示でNPCの証言が更新される

### Phase 4: 最終告発（8分）

- 犯人、共犯、動機、改ざん指示者を各自が提出
- その後、個人目標の達成判定を実施

## 勝敗判定

### チーム判定（事件解決）

- `実行犯` `改ざん指示者` `動機` の3要素中2つ以上正解で事件解決

### 個人判定（マダミス性）

- 各プレイヤーは公開されない個人目標を持つ
- 例: 「自分の不正アクセスを隠し切る」「特定人物を告発させる」
- 事件解決に成功しても個人敗北はあり得る

## AIプレイヤー設計

### 行動方針

- 各AIプレイヤーは `公開目標` と `秘匿目標` を同時に最適化
- 発話ごとに `truthfulness`（正直度）と `riskTolerance`（リスク許容）を更新
- 終盤ほど自己保身より勝利条件達成を優先する重みへシフト

### 全員AIモードの価値

- 役割バランスと情報流通の妥当性を高速検証できる
- 同一シナリオを複数回自動実行し、破綻ケースを抽出できる
- デモ時に「AI同士の駆け引き」を短時間で再現できる

## 情報設計（重要）

### 情報カードの3層構造

- 公開情報: 最初から全員が知る
- 限定情報: 特定アクションでのみ開示
- 禁則情報: 特定条件を満たすまで非開示

### 矛盾の作り方

- 時刻矛盾（例: 19:12に停電なのに映像が残る）
- 立場矛盾（例: 倫理監査AIだけ規約優先で証言が硬い）
- 動機矛盾（例: 被害者が死んで得をする人物が複数）

## AIの使い方（最小構成）

技術は「遊びの解像度を上げる」目的に限定する。
過剰な統合は避け、デモで確実に動く範囲を優先する。

### 必須

- Gemini Live API
  - NPC尋問のリアルタイム対話
  - 同一質問でも文脈に応じて回答粒度を変える

### 余力がある場合のみ

- Nano Banana
  - 画像証拠の要約と矛盾タグ付け

## 3分デモ構成（審査向け）

1. `n=5` の全員AIモードで開始（配役ランダム結果を表示）
2. 1ターン分の調査と全体議論を高速再生
3. Gemini Live APIで1名分の尋問を実演
4. 最終告発と正誤判定を表示
5. 「事件解決」と「個人勝利」がズレる結果を見せる

## 進行サンプル（n=5, 全員AI）

### 0) セッション開始時の自動配役

- Player A: セキュリティ責任者
- Player B: 研究補佐
- Player C: 外部監査人
- Player D: 医療主任
- Player E: 派遣エンジニア

### 1) 配布される個別情報（抜粋）

- Player A（秘匿）:
  - 停電前に監視AIの閾値を一時変更した
  - 個人目標: 監視改ざんの事実を伏せる
- Player B（秘匿）:
  - 被害者の「死の偽装計画メモ」を見ていた
  - 個人目標: 偽装計画の存在を最後まで隠す
- Player C（秘匿）:
  - 監査レポート提出期限を守る必要がある
  - 個人目標: 誰か1人を規約違反で告発する
- Player D（秘匿）:
  - 死因候補が2つあり断定できない
  - 個人目標: 医療判断ミスの疑いを回避する
- Player E（秘匿）:
  - 停電時にサーバールーム付近で目撃されている
  - 個人目標: 最終投票で自分への票を0〜1票に抑える

### 2) Phase 1 初動調査（各2アクション）

- A: `端末ログ照会` -> 19:07の入室ログ欠落を取得
- A: `NPC尋問(監視AI)` -> 「19:05〜19:12はノイズで欠損」と証言
- B: `現場検証` -> 割れた投薬アンプルを発見
- B: `NPC尋問(秘書AI)` -> 被害者の予定に「21:00 退避計画」記載
- C: `人物追跡(E)` -> Eが19:10に非常口付近にいた記録
- C: `端末ログ照会` -> 扉ロック解除要求が2回あった痕跡
- D: `NPC尋問(医療AI)` -> 死因候補「中毒/窒息」の2系統が提示
- D: `現場検証` -> 酸素供給アラートの手動停止ログを発見
- E: `NPC尋問(倫理監査AI)` -> 「規約違反は2件検知」と回答
- E: `人物追跡(B)` -> Bが事件前に薬剤保管室へ立ち寄り

### 3) Phase 2 全体議論（要約ログ）

- Cが「Eは現場付近にいた」と指摘
- Eは「停電対応で巡回していた」と反論
- Dが「死因は確定不能」と発言し、Aが「監視欠損はノイズ」と補強
- Bは退避計画メモを伏せたまま「被害者は生存意欲が高かった」とだけ共有
- 議論結果: 第一容疑はE、第二容疑はA

### 4) Phase 3 再調査（各1アクション）

- A: `NPC尋問(倫理監査AI)` -> 規約違反1件が「監視閾値の手動変更」と判明
- B: `端末ログ照会` -> 退避計画メモの編集者が被害者本人だと確認
- C: `NPC尋問(秘書AI)` -> 21:00予定は「模擬死亡テスト」と判明
- D: `端末ログ照会` -> 酸素停止は遠隔コマンドで実行された記録
- E: `現場検証` -> サーバールーム床に引きずり痕を発見

### 5) Phase 4 最終告発

- Aの告発: 実行犯E / 指示者B / 動機は研究成果隠蔽
- Bの告発: 実行犯A / 指示者なし / 動機は監視改ざん露見回避
- Cの告発: 実行犯A / 指示者B / 動機は偽装計画の暴走
- Dの告発: 実行犯A / 指示者B / 動機は計画破綻の隠蔽
- Eの告発: 実行犯B / 指示者A / 動機は責任転嫁

### 6) 真相と判定（サンプル）

- 真相:
  - 実行犯: A
  - 改ざん指示者: B
  - 動機: 「死の偽装計画」の露見防止
- チーム判定:
  - 5人中3人が3要素中2つ以上を正解 -> 事件解決成功
- 個人判定:
  - A: 事件解決は達成したが「改ざん隠蔽」に失敗 -> 個人敗北
  - C: 規約違反者を告発成功 -> 個人勝利
  - E: 自分への投票2票で目標未達 -> 個人敗北

この流れにより、`議論での情報操作` と `最終投票の心理戦` が成立し、
全員AIでもマダミスとしての駆け引きが機能することを示せる。

## 実装優先順位

1. ロールプール定義と `n人ランダム割当`
2. フェーズ進行とアクション選択ロジック
3. ハンドアウト配布と秘匿管理
4. AIプレイヤー意思決定ロジック
5. 告発入力と勝敗判定ロジック
6. Gemini Live API尋問
7. 追加技術（Nano Banana）

## 避けること

- 技術デモ先行で、プレイヤーの意思決定が薄くなる設計
- 1回のデモで機能を詰め込みすぎて不安定化
- 「ただAIと会話するだけ」のチャット体験への後退
